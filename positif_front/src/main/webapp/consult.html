<%@ page contentType="text/html;charset=utf-8" pageEncoding="UTF-8" %>
<div class="ui equal width stackable two column grid">
	<div class="column">
		<h2>Liste des Médiums</h2>
		<div style="overflow-y: auto; max-height: 70vh;">
		<table class="ui violet table">
			<thead>
				<tr>
				    <th>Médium</th>
				    <th>Talent</th>
			  	</tr>
			</thead>
			  <tbody id="mediums_container">
			    
			  </tbody>
		</table>
	</div>
	</div>
	<div class="column">
		<h2>Biographie du Médium</h2>
		<div class="ui segment" style="text-align: justify; overflow-y: auto; max-height: 61vh;">
			<p id="bio_container">
					
			</p>
		</div>
			<button style="width:100%" class="ui yellow button">Demander une voyance</button>
	</div>
	<div class="my_alert">
		<div id="data_error" class="mini error ui message">
		    <i class="close icon" onclick=" $(this).closest('.error.message').transition('zoom');"></i>
		    <div class="header">
		        Les données n'ont pas pu être récupérées
		    </div>
		    <p>Veuillez réessayer ultérieurement.</p>
		</div>
		<div id="server_error" class="mini error ui message">
		    <i class="close icon" onclick=" $(this).closest('.message').transition('zoom');"></i>
		    <div class="header">
		        Erreur interne du serveur
		    </div>
		    <p>Veuillez réessayer ultérieurement.</p>
		</div>
	</div>
	<script type="text/javascript">
		$('document').ready(() => {
		    console.log('document is ready');             
	        $.ajax({
	            url: './ActionServlet',
	            type: 'POST',
	            dataType: 'json',
	            data: 'todo=getMediumList',
	            success: (resp) => {
	                console.log('request success');
	                console.log(resp);
	                if(resp.success) {
	                	console.log(resp);
	                	for(m in resp.data) {
	                		$('#mediums_container').append(`
	                		<tr onclick="printBio()">
							    <td>`+m.getNom()+`</td>
							    <td>`+m.getTalent()+`</td>
							    <span style="display: none">`+m.getBio()`+</span>
			    			</tr>`)
	                	}	
	                }
	                else {
	                    $('#data_error').transition('jiggle');
	                }
	            },
	            error: function(xhr, resp, text) {
	                $('#server_error').transition('jiggle');
	                console.log(xhr, resp, text);
	                /*document.open();
	                document.write(xhr.responseText);
	                document.close();*/
	            },
	        });
	    });
		function printBio() {
			console.log("Sélection d'un médium");
			$('#bio_container').text($(this).children('span').text());
		}
	</script>
</div>	